{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[],"mount_file_id":"1q12BRIp8tfVcPtMVhYwNaQpYV2u-CDOr","authorship_tag":"ABX9TyMGeMNt4R5u8bevJN9zIyBM"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"048cf020b0a84172932d1b640dd6ca90":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_7dc53fee993344f8a892e0b18406caf5","IPY_MODEL_2b3d8a34bbea472e888f30b6a1a16818","IPY_MODEL_451658862f414103a03775a0cab997cb"],"layout":"IPY_MODEL_575f2696ed4147d7b1ff2583c7c1ec8b"}},"7dc53fee993344f8a892e0b18406caf5":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_4c52116a190e41a199c283e82d9d9e17","placeholder":"​","style":"IPY_MODEL_389bd915b0314447a2bb864391480519","value":""}},"2b3d8a34bbea472e888f30b6a1a16818":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_677d62761f3547eab35018a9df5f6f93","max":100,"min":0,"orientation":"horizontal","style":"IPY_MODEL_32ee21b7a51b49fe804f3e760bd1e8a2","value":100}},"451658862f414103a03775a0cab997cb":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_8724eb94748a40cea3bcd9485e7b225e","placeholder":"​","style":"IPY_MODEL_4e6dadb92da24c22b6cb7e16d2592864","value":" 300/? [00:43&lt;00:00,  8.47it/s]"}},"575f2696ed4147d7b1ff2583c7c1ec8b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4c52116a190e41a199c283e82d9d9e17":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"389bd915b0314447a2bb864391480519":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"677d62761f3547eab35018a9df5f6f93":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"32ee21b7a51b49fe804f3e760bd1e8a2":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"8724eb94748a40cea3bcd9485e7b225e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4e6dadb92da24c22b6cb7e16d2592864":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49,"referenced_widgets":["048cf020b0a84172932d1b640dd6ca90","7dc53fee993344f8a892e0b18406caf5","2b3d8a34bbea472e888f30b6a1a16818","451658862f414103a03775a0cab997cb","575f2696ed4147d7b1ff2583c7c1ec8b","4c52116a190e41a199c283e82d9d9e17","389bd915b0314447a2bb864391480519","677d62761f3547eab35018a9df5f6f93","32ee21b7a51b49fe804f3e760bd1e8a2","8724eb94748a40cea3bcd9485e7b225e","4e6dadb92da24c22b6cb7e16d2592864"]},"id":"yLTmLm6Pksf-","executionInfo":{"status":"ok","timestamp":1751920164255,"user_tz":360,"elapsed":43617,"user":{"displayName":"Jose Alberto Santiago De la Cruz","userId":"08503411874153474204"}},"outputId":"f60aa679-1909-4dc0-95e2-13c7764c77a0"},"outputs":[{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/100 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"048cf020b0a84172932d1b640dd6ca90"}},"metadata":{}}],"source":["# Instalar librerías necesarias (Solo ejecutar si no están instaladas)\n","from IPython.utils import io\n","import tqdm.notebook\n","\n","total = 100\n","with tqdm.notebook.tqdm(total=total) as pbar:\n","    with io.capture_output() as captured:\n","        # Instalar rdkit\n","        !pip -q install rdkit.pypi==2021.9.4\n","        pbar.update(20)\n","        # Instalar Pillow\n","        !pip -q install Pillow\n","        pbar.update(40)\n","        # Instalar molplotly\n","        !pip install molplotly\n","        pbar.update(60)\n","        # Instalar jupyter-dash\n","        !pip install jupyter-dash\n","        pbar.update(80)\n","        # Instalar el diseño de aplicación dash\n","        !pip install dash-bootstrap-components\n","        pbar.update(100)\n"]},{"cell_type":"code","source":["# Importar librerías\n","import pandas as pd\n","import numpy as np\n","from sklearn.svm import SVC\n","from sklearn.metrics import (accuracy_score, confusion_matrix, ConfusionMatrixDisplay,\n","                            precision_score, recall_score, f1_score,\n","                            cohen_kappa_score, matthews_corrcoef,\n","                            roc_curve, auc, make_scorer)\n","from sklearn.model_selection import train_test_split, cross_val_score, cross_val_predict, KFold\n","import matplotlib.pyplot as plt"],"metadata":{"id":"QXbFau6Sk4ZM","executionInfo":{"status":"ok","timestamp":1751920634623,"user_tz":360,"elapsed":1414,"user":{"displayName":"Jose Alberto Santiago De la Cruz","userId":"08503411874153474204"}}},"execution_count":1,"outputs":[]},{"cell_type":"code","source":["# Leer bases de datos\n","datos = \"/content/drive/MyDrive/INGER/ETAPA 2024/Version Final/0. Data Set/Concatenadas.csv\"\n","datos = pd.read_csv(datos)\n"],"metadata":{"id":"M2su6C_Wk7xc","executionInfo":{"status":"ok","timestamp":1751920674797,"user_tz":360,"elapsed":11,"user":{"displayName":"Jose Alberto Santiago De la Cruz","userId":"08503411874153474204"}}},"execution_count":4,"outputs":[]},{"cell_type":"code","source":["# Agregar una columna de índices\n","datos['Index'] = datos.index"],"metadata":{"id":"OtjSl27zk7uj","executionInfo":{"status":"ok","timestamp":1751920675863,"user_tz":360,"elapsed":13,"user":{"displayName":"Jose Alberto Santiago De la Cruz","userId":"08503411874153474204"}}},"execution_count":5,"outputs":[]},{"cell_type":"code","source":["# Información del dataset\n","datos.info()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"63rTFZbmk7sT","executionInfo":{"status":"ok","timestamp":1751920677464,"user_tz":360,"elapsed":24,"user":{"displayName":"Jose Alberto Santiago De la Cruz","userId":"08503411874153474204"}},"outputId":"54ae75a9-30a8-4116-bdfc-80f8bd5daa1e"},"execution_count":6,"outputs":[{"output_type":"stream","name":"stdout","text":["<class 'pandas.core.frame.DataFrame'>\n","RangeIndex: 405 entries, 0 to 404\n","Data columns (total 48 columns):\n"," #   Column                     Non-Null Count  Dtype  \n","---  ------                     --------------  -----  \n"," 0   Name                       405 non-null    object \n"," 1   Total Molweight            405 non-null    float64\n"," 2   Monoisotopic Mass          405 non-null    float64\n"," 3   cLogP                      405 non-null    float64\n"," 4   cLogS                      405 non-null    float64\n"," 5   H-Acceptors                405 non-null    int64  \n"," 6   H-Donors                   405 non-null    int64  \n"," 7   Total Surface Area         405 non-null    float64\n"," 8   Relative PSA               405 non-null    float64\n"," 9   Polar Surface Area         405 non-null    float64\n"," 10  Druglikeness               405 non-null    float64\n"," 11  Shape Index                405 non-null    float64\n"," 12  Molecular Flexibility      405 non-null    float64\n"," 13  Molecular Complexity       405 non-null    float64\n"," 14  Fragments                  405 non-null    int64  \n"," 15  Non-H Atoms                405 non-null    int64  \n"," 16  Non-C/H Atoms              405 non-null    int64  \n"," 17  Metal-Atoms                405 non-null    int64  \n"," 18  Electronegative Atoms      405 non-null    int64  \n"," 19  Stereo Centers             405 non-null    int64  \n"," 20  Rotatable Bonds            405 non-null    int64  \n"," 21  Rings Closures             405 non-null    int64  \n"," 22  Aromatic Atoms             405 non-null    int64  \n"," 23  sp3-Atoms                  405 non-null    int64  \n"," 24  Symmetric atoms            405 non-null    int64  \n"," 25  Small Rings                405 non-null    int64  \n"," 26  Carbo-Rings                405 non-null    int64  \n"," 27  Hetero-Rings               405 non-null    int64  \n"," 28  Saturated Rings            405 non-null    int64  \n"," 29  Non-Aromatic Rings         405 non-null    int64  \n"," 30  Aromatic Rings             405 non-null    int64  \n"," 31  Saturated Carbo-Rings      405 non-null    int64  \n"," 32  Non-Aromatic Carbo-Rings   405 non-null    int64  \n"," 33  Carbo-Aromatic Rings       405 non-null    int64  \n"," 34  Saturated Hetero-Rings     405 non-null    int64  \n"," 35  Non-Aromatic Hetero-Rings  405 non-null    int64  \n"," 36  Hetero-Aromatic Rings      405 non-null    int64  \n"," 37  Amides                     405 non-null    int64  \n"," 38  Amines                     405 non-null    int64  \n"," 39  Alkyl-Amines               405 non-null    int64  \n"," 40  Aromatic Amines            405 non-null    int64  \n"," 41  Aromatic Nitrogens         405 non-null    int64  \n"," 42  Basic Nitrogens            405 non-null    int64  \n"," 43  Acidic Oxygens             405 non-null    int64  \n"," 44  Geroprotectors             405 non-null    int64  \n"," 45  DataSet                    405 non-null    object \n"," 46  Smile                      405 non-null    object \n"," 47  Index                      405 non-null    int64  \n","dtypes: float64(11), int64(34), object(3)\n","memory usage: 152.0+ KB\n"]}]},{"cell_type":"code","source":["# Separar las columnas de las variables predictorias (X) de la columna que contiene la variable a predecir (Y)\n","columnas_interes = [1, 3, 5, 6, 7, 8, 20]\n","X = datos.iloc[:, columnas_interes]\n","y = datos.iloc[:, 44]"],"metadata":{"id":"dN3HThXjk7ek","executionInfo":{"status":"ok","timestamp":1751920686749,"user_tz":360,"elapsed":8,"user":{"displayName":"Jose Alberto Santiago De la Cruz","userId":"08503411874153474204"}}},"execution_count":7,"outputs":[]},{"cell_type":"code","source":["# Separar datos en conjuntos de entrenamiento y prueba (80-20)\n","X_train, X_test, y_train, y_test = train_test_split(X, y, train_size=0.8, random_state=42)"],"metadata":{"id":"if_lFUCjlhYU","executionInfo":{"status":"ok","timestamp":1751920694583,"user_tz":360,"elapsed":53,"user":{"displayName":"Jose Alberto Santiago De la Cruz","userId":"08503411874153474204"}}},"execution_count":8,"outputs":[]},{"cell_type":"code","source":["# Crear el modelo SVM\n","svm_model = SVC(kernel='linear', random_state=42, probability=True)"],"metadata":{"id":"L3ju_r2FlhVT","executionInfo":{"status":"ok","timestamp":1751920701510,"user_tz":360,"elapsed":5,"user":{"displayName":"Jose Alberto Santiago De la Cruz","userId":"08503411874153474204"}}},"execution_count":9,"outputs":[]},{"cell_type":"code","source":["# ========== VALIDACIÓN CRUZADA K-FOLD (k=5) ==========\n","# Configurar k-fold cross validation\n","kfold = KFold(n_splits=5, shuffle=True, random_state=42)\n","\n","# Función para calcular especificidad\n","def specificity_score(y_true, y_pred):\n","    cm = confusion_matrix(y_true, y_pred)\n","    tn = cm[0, 0]\n","    fp = cm[0, 1]\n","    return tn / (tn + fp)\n","\n","# Métricas a evaluar\n","scoring = {\n","    'accuracy': 'accuracy',\n","    'precision': make_scorer(precision_score, average='weighted'),\n","    'recall': make_scorer(recall_score, average='weighted'),\n","    'f1': make_scorer(f1_score, average='weighted'),\n","    'specificity': make_scorer(specificity_score),\n","    'kappa': make_scorer(cohen_kappa_score),\n","    'mcc': make_scorer(matthews_corrcoef)\n","}"],"metadata":{"id":"jig-QhXolhSj","executionInfo":{"status":"ok","timestamp":1751920717679,"user_tz":360,"elapsed":25,"user":{"displayName":"Jose Alberto Santiago De la Cruz","userId":"08503411874153474204"}}},"execution_count":10,"outputs":[]},{"cell_type":"code","source":["# Realizar cross-validation para todas las métricas\n","print(\"\\n=== RESULTADOS DE VALIDACIÓN CRUZADA (5-fold) ===\")\n","for metric_name, metric_scorer in scoring.items():\n","    cv_scores = cross_val_score(svm_model, X_train, y_train, cv=kfold, scoring=metric_scorer)\n","    print(f\"{metric_name.capitalize()}: {cv_scores.mean():.4f} (±{cv_scores.std():.4f})\")\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"PBiHWdj0nLk0","executionInfo":{"status":"ok","timestamp":1751921471524,"user_tz":360,"elapsed":742387,"user":{"displayName":"Jose Alberto Santiago De la Cruz","userId":"08503411874153474204"}},"outputId":"1606c072-211e-45ea-ff5e-6a9bdef73f3f"},"execution_count":11,"outputs":[{"output_type":"stream","name":"stdout","text":["\n","=== RESULTADOS DE VALIDACIÓN CRUZADA (5-fold) ===\n","Accuracy: 0.6107 (±0.0649)\n","Precision: 0.6297 (±0.0558)\n","Recall: 0.6107 (±0.0649)\n","F1: 0.5945 (±0.0702)\n","Specificity: 0.8023 (±0.0419)\n","Kappa: 0.2176 (±0.1009)\n","Mcc: 0.2330 (±0.1067)\n"]}]},{"cell_type":"code","source":[],"metadata":{"id":"bmLXpLB1nWa9"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"XCpg6cRnnWYc"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"G-gA_NctnWVl"},"execution_count":null,"outputs":[]}]}